自動実行される処理の説明


1. スプレッドシートを開いたときに実行される処理

スプレッドシートを開いたときに自動的に実行される関数は、以下の処理を行います。

・サイドバーの表示: サイドバーを表示し、ユーザーがデータ取得やレポート作成を行えるようにします。
・カスタムメニューの表示: スプレッドシートのメニューに「初期設定」というカスタムメニューを追加し、ユーザーがMetaトークンの登録などを行えるようにします。
・Apps Scriptのリンクを表示: 開発用に、現在のスクリプトのリンクを表示するダイアログを表示します。
・スクリプトプロパティのチェック: 必要なスクリプトプロパティが設定されているかどうかをチェックし、設定されていない場合はユーザーに入力を促します。


2. トリガーの追加

初期設定時にトリガーを追加する処理は、以下のトリガーを設定します。

・スプレッドシートを開いたときのトリガー: スプレッドシートを開いたときに、サイドバーとカスタムメニューを表示する処理を実行します。
・月次トリガー: 毎月1日に、アクセストークンを更新する処理を実行します。
・日次トリガー: 毎日午前5時に、前日の広告セットを取得する処理を実行します。


3. スクリプトプロパティの初期化

初期設定時にスクリプトプロパティを初期化する処理は、以下のプロパティを設定します。

・MetaアプリのAPIバージョン
・DifyのアプリケーションID
・広告アカウントID
・MetaアプリのアプリID
・Metaアプリのapp secret
・Metaアプリのアクセストークン
・これらのプロパティは、初回は追加され、2回目以降は更新されます。

まとめ
これらの自動実行される関数は、スプレッドシートを開いたときや定期的なタイミングで必要な処理を自動的に実行し、ユーザーがスムーズに作業を進められるようにサポートします。